<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>
Weld: News
</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<meta content="Latest news about Weld." name="description">
<link href="/images/weld_icon_32x.ico" rel="shortcut icon" type="image/x-icon">
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href="//static.jboss.org/css/tabzilla.css" media="screen" rel="stylesheet" type="text/css">
<link href="https://weld.cdi-spec.org/stylesheets/styles.css" rel="stylesheet" type="text/css">
<script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="//static.jboss.org/js/_jbossorg-tabzilla.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="//html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
<![endif]-->
<link href="https://weld.cdi-spec.org/news.atom" rel="alternate" type="application/atom+xml">
<link href="//cdn.jsdelivr.net/highlight.js/8.9.1/styles/hybrid.min.css" rel="stylesheet">
<script src="//cdn.jsdelivr.net/highlight.js/8.9.1/highlight.min.js" type="text/javascript"></script>
<script>
hljs.initHighlightingOnLoad();
</script>
</head>
<body>
<div class="container-fluid">
<div class="row">
<div class="col-md-2 col-sm-3">
<div class="sidebar-nav">
<div class="navbar navbar-default" role="navigation">
<div class="navbar-header">
<button ="button" class="navbar-toggle" data-target=".sidebar-navbar-collapse" data-toggle="collapse">
<span class="sr-only">
Toggle navigation
</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a ="#" class="visible-xs navbar-brand">
<img alt="Weld Logo" src="/images/weld_logo_100x.png">
</a>
</div>
<div class="collapse navbar-collapse sidebar-navbar-collapse">
<ul class="nav navbar-nav">
<li>
<a href="/">
<i class="fa fa-home"></i>
&nbsp;Home
</a>
</li>
<li>
<a href="/download">
<i class="fa fa-download"></i>
&nbsp;Download
</a>
</li>
<li>
<a href="/news">
<i class="fa fa-newspaper-o"></i>
&nbsp;News
</a>
</li>
<li>
<a href="https://issues.jboss.org/projects/WELD?selectedItem=com.atlassian.jira.jira-projects-plugin:release-page" target="_blank">
<i class="fa fa-road"></i>
&nbsp;Road Map
</a>
</li>
<li>
<a href="/documentation">
<i class="fa fa-book"></i>
&nbsp;Docs &amp; FAQ
</a>
</li>
<li>
<a href="/news/tags/tips">
<i class="fa fa-lightbulb-o"></i>
&nbsp;Tips and Tricks
</a>
</li>
<li>
<a href="/community">
<i class="fa fa-group"></i>
&nbsp;Community
</a>
</li>
<li>
<a href="http://github.com/weld" target="_blank">
<i class="fa fa-github-alt"></i>
&nbsp;Source Code
</a>
</li>
<li>
<a href="https://issues.jboss.org/browse/WELD#selectedTab=com.atlassian.jira.plugin.system.project%3Asummary-panel" target="_blank">
<i class="fa fa-tasks"></i>
&nbsp;Bug Tracker
</a>
</li>
<li>
<a href="https://twitter.com/jbossweld" target="_blank">
<i class="fa fa-twitter"></i>
&nbsp;Follow @jbossweld
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="col-md-10 col-sm-9">
<div class="row hidden-xs">
<div class="dropup">
<div id="ajbossproject">
A JBoss Project
</div>
<a class="tabnav-closed" href="#" id="tab">Red Hat</a>
<script>
window.addEventListener('load', function() {renderTabzilla("Weld", "weld", false )}, false);
</script>
</div>
</div>
<div class="row">
<div class="col-md-4">
<a href="/">
<img alt="Weld Logo" class="hidden-xs weld-home-logo" src="/images/weld_logo_450x.png">
</a>
</div>
<div class="col-md-8">
<img alt="CDI tagcloud" class="hidden-xs hidden-sm cdi-background" src="/images/CDIbackground.png">
</div>
</div>
<div class="row content-wrapper">
<div class="col-md-12">
<h1>
News
<a href="http://weld.cdi-spec.org/news.atom">
<i class="fa fa-rss"></i>
</a>
</h1>
<div class="post">
<h2>
<a href="/news/2014/12/10/an-update-on-weld-3/">An update on Weld 3</a>
</h2>
<div class="news-date news-boxed">
2014-12-10
&nbsp;
<span class="tags">
<i class="fa fa-tags"></i>
<a href="/news/tags/cdi2">cdi2</a>
</span>
&nbsp;
<i class="fa fa-pencil"></i>
Jozef Hartinger
</div>
<p></p>
<div class="content">
<div class="paragraph">
<p>Today we are releasing the third Alpha release of Weld 3. These Alpha releases serve
as prototypes of changes currently being discussed by the CDI expert group for
the upcoming CDI 2.0.</p>
</div>
<div class="paragraph">
<p>The Alpha releases are not suitable for production use as the new API and functionality
are still subject to change. We are releasing them to allow the community to test-drive
the changes early in the development cycle. We want to shorten the feedback loop and
identify possible glitches as soon as possible.</p>
</div>
<div class="paragraph">
<p>Let’s just quickly review what has been available since Alpha1:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>declarative ordering of observer methods using <code>@Priority</code></p>
</li>
<li>
<p>ability for an extension to veto and modify an observer method</p>
</li>
<li>
<p>support for Java 8 repeatable annotations as qualifiers and interceptor bindings</p>
</li>
<li>
<p>enhanced <code>AnnotatedType</code> API</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more details and examples of these features see my
<a href="http://weld.cdi-spec.org/news/2014/10/02/weld-300Alpha1/">previous blog post</a>.</p>
</div>
<div class="paragraph">
<p>On top of this, we’re now adding the <strong>following new features and enhancements</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>asynchronous events</p>
</li>
<li>
<p>simplified configuration of Weld-specific properties</p>
</li>
<li>
<p>Guava is no longer used internally</p>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_asynchronous_events">Asynchronous events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since its first version CDI has provided events as a facility for component interaction.
Events enable loose coupling while preserving type safety.
So far, CDI has supported synchronous delivery of events - the calling thread blocks
until invocations of all associated observer methods complete. An alternative to
this are transactional observer methods which are called asynchronously at the end
of a transaction.</p>
</div>
<div class="paragraph">
<p>For the upcoming CDI 2.0 specification one of the hot topics is enhancement of the
events facility. The expert group is
<a href="https://docs.google.com/document/d/1pDO7gru6YuEyTDdK3XBozvXZYucT9uC7McZMffSZun4/edit?usp=sharing">considering adding fully asynchronous event dispatching mechanism</a>.</p>
</div>
<div class="paragraph">
<p>A working prototype of this is available in Weld 3.0.0.Alpha3. The current proposal
adds a method called <code>fireAsync</code> to the existing <code>Event</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject&#x000A;private ExperimentalEvent&lt;Configuration&gt; event;&#x000A;…&#x000A;event.fireAsync(new Configuration());</code></pre>
</div>
</div>
<div class="paragraph">
<p>The call to <code>event.fireAsync()</code> returns immediately. The event is delivered to
corresponding observers in a dedicated thread pool that can be configured.</p>
</div>
<div class="sect2">
<h3 id="_what_about_thread_safety">What about thread-safety?</h3>
<div class="paragraph">
<p>There are two common usage pattens for events. In the first one an immutable event
object is used. An alternative is to use mutable events. A mutable event allows
observers to participate on the result which is later used by the component that
fired the event. An example of this would be the
<a href="https://docs.oracle.com/javaee/6/api/javax/enterprise/inject/spi/ProcessAnnotatedType.html">ProcessAnnotatedType&lt;T&gt;</a>
event used by CDI extensions. When events are fired synchronously, both
approaches work fine but how does this work when we switch to async?</p>
</div>
<div class="paragraph">
<p>Nothing changes actually. No matter if the event object is immutable or not, you
do not have to worry about thread-safety of the event object. The current implementation
comes with the guarantee that event object is safely published which means that
an observer method observes the event in the state in which:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it was left by an observer executing before the given observer, or</p>
</li>
<li>
<p>the initial state of the event if the given observer is the first one</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore, the state is consistent throughout the execution of an observer method
which means that we guarantee safe publication and prevent races for you. The only
thing that should be avoided is modifying the state of the event object outside of
an observer method. This behavior matches the
<a href="https://docs.google.com/document/d/1lFtgLm6hY-uECdA1r0Sfimq6vkVYThoUZsevPUaSP0E/edit?usp=sharing">option 4.1.1.1 in the current spec proposal</a>.</p>
</div>
<div class="paragraph">
<p>Update: new <a href="https://docs.google.com/document/d/1pDO7gru6YuEyTDdK3XBozvXZYucT9uC7McZMffSZun4/edit?usp=sharing">link for a planning document</a></p>
</div>
<div class="paragraph">
<p>In addition, if observer methods are ordered (another new feature proposed for CDI 2.0)
we preserve the ordering (as in such situation the observers are ordered for a reason!)
and invoke observers in the given order.</p>
</div>
<div class="paragraph">
<p>Last but not least, if an observer is transactional, we again preserve this and
invoke the observer method in the corresponding transaction phase.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_do_i_know_when_event_delivery_finishes_and_what_about_exceptions">How do I know when event delivery finishes and what about exceptions?</h3>
<div class="paragraph">
<p>In the current prototype we’re reusing the
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletionStage.html">CompletionStage</a>
API, introduced in Java 8, which allows actions (callbacks) to be bound to the completion of the
asynchronous delivery process. This is what it looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">event.fireAsync(new Configuration()).thenAccept(config -&gt; master.compute(config));</code></pre>
</div>
</div>
<div class="paragraph">
<p>This piece of code starts with asynchronously firing a mutable configuration object
allowing loosely-coupled observers to alter the configuration of a computation.
Once all observers finish, computation is initiated based on the resulting configuration.</p>
</div>
<div class="paragraph">
<p>If an exception occurs this can be dealt with also, either by falling back to a default value</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">event.fireAsync(new Configuration())&#x000A;    .exceptionally(throwable -&gt; DEFAULT_CONFIGURATION)&#x000A;    .thenAccept((config) -&gt; master.compute(config));</code></pre>
</div>
</div>
<div class="paragraph">
<p>or by executing arbitrary code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">event.fireAsync(new Configuration()).whenComplete((config, throwable) -&gt; {&#x000A;    if (throwable != null) {&#x000A;        System.err.println("Oops. Failed because of " + throwable.getMessage());&#x000A;    } else {&#x000A;        master.compute(config);&#x000A;    }&#x000A;});</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>CompletionStage</code> allows much more. If you are unfamiliar with the API see the
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletionStage.html">Javadoc</a>
page for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_do_i_try_this_myself">How do I try this myself?</h3>
<div class="paragraph">
<p>It’s easy and multiple options are available. First of them is to use Weld in a
<strong>standalone application</strong>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new Java SE application.</p>
</li>
<li>
<p>Add dependency on Weld</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">&lt;dependency&gt;&#x000A;    &lt;groupId&gt;org.jboss.weld.se&lt;/groupId&gt;&#x000A;    &lt;artifactId&gt;weld-se-core&lt;/artifactId&gt;&#x000A;    &lt;version&gt;3.0.0.Alpha3&lt;/version&gt;&#x000A;&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Create an empty <code>beans.xml</code> file, e.g.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="shell" class="language-shell hljs">mkdir src/main/resources/META-INF&#x000A;touch src/main/resources/META-INF/beans.xml</code></pre>
</div>
</div>
</li>
<li>
<p>Launch Weld and fire an event asynchronously</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public static void main(String[] args) {&#x000A;    WeldContainer weld = new Weld().initialize();&#x000A;    Event&lt;String&gt; evnt = weld.event().select(String.class);&#x000A;    ExperimentalEvent&lt;String&gt; event = (ExperimentalEvent&lt;String&gt;) evnt;&#x000A;&#x000A;    event.fireAsync("message");&#x000A;}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_wildfly">WildFly</h4>
<div class="paragraph">
<p>Alternatively, a patch is available for WildFly that upgrades Weld within an existing WildFly instance. See the
<a href="http://sourceforge.net/projects/jboss/files/Weld/3.0.0.Alpha3">download page</a>
for more details.</p>
</div>
<div class="paragraph">
<p>Note that these new prototyped APIs are not part of the CDI API yet. Instead, they are currently located
in
<a href="http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22org.jboss.weld%22%20AND%20a%3A%22weld-api%22">Weld API</a>
in a package named
<a href="http://docs.jboss.org/weld/javadoc/3.0/weld-api/org/jboss/weld/experimental/package-frame.html">org.jboss.weld.experimental</a></p>
</div>
<div class="paragraph">
<p>All these altered APIs have the <code>Experimental</code> prefix (that&#8217;s why we are using <code>ExperimentalEvent</code> in the examples)</p>
</div>
<div class="paragraph">
<p><strong>We would appreciate your feedback!</strong> Feel free to use
<a href="https://community.jboss.org/en/weld?view=discussions">Weld forums</a>
or the
<a href="https://lists.jboss.org/mailman/listinfo/cdi-dev">cdi-dev mailing list</a>
for this purpose.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_whats_next">What’s next?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We are going to continue releasing early prototypes of features currently proposed for
CDI 2.0. The plan is to release a new Alpha version every 3 weeks. There are several
areas we want to focus on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>simplifying how extensions register beans and observers</p>
</li>
<li>
<p>monitoring and debugging of CDI applications</p>
</li>
<li>
<p>experimenting with full interception (intercepting even calls within a given component)</p>
</li>
<li>
<p>splitting the codebase into a “light” and “full” version (to support proposed <strong>CDI light</strong> version)</p>
</li>
<li>
<p>bootstrap API for SE environment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#91; <a href="http://docs.jboss.org/weld/javadoc/3.0/weld-api/org/jboss/weld/experimental/package-frame.html">Experimental API documentation</a> &#93;
&#91; <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310891&amp;version=12325836">Release notes</a> &#93;
&#91; <a href="https://sourceforge.net/projects/jboss/files/Weld/3.0.0.Alpha3">Distribution</a> &#93;
&#91; Patch for Wildfly
(<a href="http://sourceforge.net/projects/jboss/files/Weld/3.0.0.Alpha3/wildfly-8.2.0.Final-weld-3.0.0.Alpha3-patch.zip/download">8.2</a>,
<a href="http://sourceforge.net/projects/jboss/files/Weld/3.0.0.Alpha3/wildfly-9.0.0.Alpha1-weld-3.0.0.Alpha3-patch.zip/download">9 Alpha</a>)
&#93;</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div class="post">
<h2>
<a href="/news/2014/10/02/weld-300Alpha1/">Weld 3.0.0.Alpha1 released!</a>
</h2>
<div class="news-date news-boxed">
2014-10-2
&nbsp;
<i class="fa fa-pencil"></i>
Jozef Hartinger
</div>
<p></p>
<div class="content">
<div class="paragraph">
<p>Today we are releasing Weld 3.0.0.Alpha1. This release serves as an <strong>early proof of concept</strong> of some of the ideas that are being discussed by the CDI Expert Group for the upcoming
<a href="http://cdi-spec.org/">CDI 2.0 specification</a>. Furthermore, this is a great opportunity for the community to test-drive some of the proposed improvements and <strong>provide us with feedback</strong>.
Be warned though that this released does not come with any guarantee of stability and that binary and functional compatibility is likely to be broken in the following releases.</p>
</div>
<div class="sect1">
<h2 id="_ordering_of_observer_methods">Ordering of observer methods</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first of the new features are ordered observer methods. This requirement came up a long ago and several approaches were proposed in the meantime, as documented by
<a href="https://issues.jboss.org/browse/CDI-4">CDI-4</a>.The Alpha1 release employs the general-purpose <code>@Priority</code> annotation to determine the order in which observer methods are to be notified.</p>
</div>
<div class="paragraph">
<p>There are many open questions about this feature. Here are some of the rules we set for the purpose of this experimental implementation. These are by no means set in stone but instead we encourage you
to give us feedback on these:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each observer method has a certain priority value. An observer method that does not define a priority explicitly is given the default priority which is 2500 (in the middle of the <code>Interceptor.Priority.APPLICATION</code> range)</p>
</li>
<li>
<p>The priority of an observer method determines the order. An observer method with lower value is called before an observer method with higher value</p>
</li>
<li>
<p>If multiple observer methods define the same priority value, the order is undefined</p>
</li>
<li>
<p>Observer methods priorities should match <a href="https://javaee-spec.java.net/nonav/javadocs/javax/interceptor/Interceptor.Priority.html">existing priority range convention</a></p>
</li>
<li>
<p>The ordering applies to both transactional and non-transactional observer methods</p>
</li>
<li>
<p>The priority annotation is applied on the event parameter (not the observer method)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here’s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public void sendWelcome(@Observes @Priority(APPLICATION + 800) @Registered User user) {&#x000A;    // ...&#x000A;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>javax.annotation.Priority</code> can currently only be applied to types. Therefore, we temporarily created a substitute called <strong><code>org.jboss.weld.experimental.Priority</code></strong> which is identical
to the original except that it can also be applied on parameters (of observer methods). The plan is to propagate this change back to <code>javax.annotation.Priority</code>. In the meantime, Weld’s twin
gets the job done.</p>
</div>
<div class="paragraph">
<p>In addition to the <code>@Priority</code> annotation, the SPI was also enhanced to expose the priority of an observer method. We are not touching <code>javax.enterprise</code> interfaces just yet. Instead,
the <code>org.jboss.weld.experimental</code> package contains proposals for how the new SPI should look like. As the package name suggests, this SPI is good for a test-drive but do not expect it to be stable.
To use the experimental SPIs, you&#8217;ll need to add a dependency on <a href="http://search.maven.org/#artifactdetails%7Corg.jboss.weld%7Cweld-api%7C3.0.Alpha1%7Cjar">weld-api</a>.</p>
</div>
<div class="paragraph">
<p>Here’s an example of reading the observer method priority using the SPI in an Extension. <code>ExperimentalProcessObserverMethod</code> and <code>ExperimentalObserverMethod</code> interfaces come from the
<code>org.jboss.weld.experimental package</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class SimpleExtension implements Extension {&#x000A;&#x000A;    void observe(@Observes ExperimentalProcessObserverMethod&lt;User, ?&gt; event) {&#x000A;        ExperimentalObserverMethod&lt;User&gt; observerMethod = event.getObserverMethod();&#x000A;        this.priority = observerMethod.getPriority();&#x000A;    }&#x000A;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the <a href="https://issues.jboss.org/browse/CDI-4">corresponding CDI ticket</a> for any feedback on these features.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vetoing_and_modifying_observer_methods">Vetoing and modifying observer methods</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We’ll stay with observer methods for a few more paragraphs. A <a href="https://issues.jboss.org/browse/CDI-458">request</a> was raised in the CDI issue tracker for making it possible to disable an
observer method using the <code>ProcessObserverMethod</code> SPI.</p>
</div>
<div class="paragraph">
<p>This Alpha1 release introduces the <code>veto()</code> methods (aligned with <code>ProcessAnnotatedType.veto()</code>) for this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">void disableDebuggingObservers(@Observes ExperimentalProcessObserverMethod&lt;?, Debug&gt; event) {&#x000A;    if (projectStage != ProjectStage.Development) {&#x000A;        event.veto();&#x000A;    }&#x000A;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition, the observer method metadata may be altered by an extension. This is done similarly to how <code>InjectionTarget</code>, <code>InjectionPoint</code> or <code>BeanAttribute</code> metadata are modified which
is most often by wrapping the original object (decorator design pattern). Any piece of metadata (including aforementioned priority) can be altered. For example, the transaction phase:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">void alterObserver(@Observes ExperimentalProcessObserverMethod&lt;User, ?&gt; event) {&#x000A;    event.setObserverMethod(new ForwardingExperimentalObserverMethod&lt;User&gt;(event.getObserverMethod()) {&#x000A;        @Override&#x000A;        public TransactionPhase getTransactionPhase() {&#x000A;            return TransactionPhase.AFTER_SUCCESS;&#x000A;        }&#x000A;    });&#x000A;}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_repeatable_qualifiers_and_interceptor_bindings">Repeatable qualifiers and interceptor bindings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release serves as a proof of concept for supporting repeating qualifiers and interceptor bindings. You can now fully utilize Java 8 features and use multiple qualifiers or interceptor bindings
of the same type in the same location, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class School {&#x000A;&#x000A;    @Produces&#x000A;    @Speaks("English")&#x000A;    @Speaks("French")&#x000A;    public Student graduate() {&#x000A;        // ...&#x000A;    }&#x000A;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Repeating qualifiers can be used for both bean and event resolution. See the <a href="http://docs.oracle.com/javase/tutorial/java/annotations/repeating.html">Java documentation</a> for how to define
a repeating annotation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interceptor_bindings_in_invocation_context">Interceptor bindings in invocation context</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an often recurring scenario. An interceptor binding defines several <code>@NonBinding</code> members which serve as configuration for the interceptor. How does an interceptor get hold of these values?
This is not easy as the interceptor binding may often appear on the intercepted method, the class that defined it or may be inherited from another interceptor binding or stereotype (even transitively!).
This problem gave birth to utilities such as
<a href="https://git-wip-us.apache.org/repos/asf?p=deltaspike.git;a=blob;f=deltaspike/core/api/src/main/java/org/apache/deltaspike/core/util/AnnotationUtils.java;h=9d4c8e2f72936facf1ef0d8d9655c4186965afde;hb=HEAD">this one</a>.
Still, even after all this effort the result is not entirely correct as it was obtained using Java reflection ignoring the fact that the interceptor binding may have been modified
(e.g. using <code>ProcessAnnotatedType</code>).</p>
</div>
<div class="paragraph">
<p>This problem is being addressed as <a href="https://issues.jboss.org/browse/CDI-468">CDI-468</a>. The Alpha1 release of Weld implements this feature and exposes new methods for obtaining interceptor bindings
that are in effect for the interception. This is done using <code>ExperimentalInvocationContext.getInterceptorBindings()</code> or <code>ExperimentalInvocationContext.getInterceptorBindingsByType()</code>.</p>
</div>
<div class="paragraph">
<p>Again, <code>ExperimentalInvocationContext</code> can be found in the <code>org.jboss.weld.experimental</code> package and depicts how the future version of <code>javax.interceptor.InvocationContext</code> could look like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Interceptor&#x000A;@Secure&#x000A;public class SecurityInterceptor {&#x000A;&#x000A;    @Inject&#x000A;    private User user;&#x000A;&#x000A;    @AroundInvoke&#x000A;    public Object intercept(ExperimentalInvocationContext ctx) throws Exception {&#x000A;        Secure binding = ctx.getInterceptorBindingsByType(Secure.class).iterator().next();&#x000A;        if (!user.getRoles().contains(binding.requireRole())) {&#x000A;            throw new SecurityException();&#x000A;        }&#x000A;        return ctx.proceed();&#x000A;    }&#x000A;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, your feedback is welcome at <a href="https://issues.jboss.org/browse/CDI-468">CDI-468</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_changes_in_the_annotated_layer">Changes in the Annotated layer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CDI provides an abstraction over the Reflection API - <a href="http://docs.jboss.org/cdi/api/1.2/javax/enterprise/inject/spi/Annotated.html">AnnotatedType and friends</a> - which mostly allows extensions
to alter the set of annotations present on a type, field, method, etc.</p>
</div>
<div class="paragraph">
<p>The Alpha1 release contains two minor additions to this API. Firstly, the API now supports Java 8 repeating annotations with a new method <code>ExperimentalAnnotated.getAnnotationsByType(Class&lt;T&gt; annotationClass)</code></p>
</div>
<div class="paragraph">
<p>Secondly, it is now possible to access the <code>java.lang.reflect.Parameter</code> instance that is wrapped by <code>AnnotatedParameter</code> using <code>ExperimentalAnnotatedParameter.getJavaParameter();</code></p>
</div>
<div class="paragraph">
<p>See <a href="https://issues.jboss.org/browse/CDI-471">CDI-471</a> and <a href="https://issues.jboss.org/browse/CDI-481">CDI-481</a> for details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_give_it_a_try">Give it a try!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#91; <a href="http://docs.jboss.org/weld/javadoc/3.0/weld-api/org/jboss/weld/experimental/package-frame.html">Experimental API documentation</a> &#93;
&#91; <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310891&amp;version=12322333">Release notes</a> &#93;
&#91; <a href="https://sourceforge.net/projects/jboss/files/Weld/3.0.0.Alpha1">Distribution</a> &#93;
&#91; <a href="http://sourceforge.net/projects/jboss/files/Weld/3.0.0.Alpha1/wildfly-9.0.0.Alpha1-weld-3.0.0.Alpha1-patch.zip/download">Patch for WildFly 9</a> &#93;</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div class="post">
<h2>
<a href="/news/2014/09/18/weld-next/">Weld.Next</a>
</h2>
<div class="news-date news-boxed">
2014-9-18
&nbsp;
<i class="fa fa-pencil"></i>
Jozef Hartinger
</div>
<p></p>
<div class="content">
<div class="paragraph">
<p>Today, we released Weld 2.2.5.Final. The fifth mostly bug-fixing release in the series addresses <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310891&amp;version=12325389">23 issues</a>.
In addition, the Servlet module got an update and among other things now supports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all three bean discovery modes (e.g. only explicitly annotated classes will be loaded as CDI beans)</p>
</li>
<li>
<p>bean archive isolation</p>
</li>
<li>
<p>using Jandex for faster deployment discovery</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the <a href="http://docs.jboss.org/weld/reference/2.2.5.Final/en-US/html/_application_servers_and_environments_supported_by_weld.html#_servlet_containers_such_as_tomcat_or_jetty">reference documentation </a>
for details.</p>
</div>
<div class="paragraph">
<p>Talking about documentation we are grateful to <a href="http://www.next-presso.com/author/antoine/">Antoine Sabot-Durand</a> for migrating our reference documentation to <a href="http://www.methods.co.nz/asciidoc/">AsciiDoc</a>.
We also thank our community contributors <strong>Antonin Stefanutti</strong> and <strong>Stefan Grossmann</strong> who contributed with pull requests.</p>
</div>
<div class="sect1">
<h2 id="_weld_3_0">Weld 3.0</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the coming months, our focus will be shifting towards <strong>Weld 3.0</strong> - the future reference implementation of <a href="http://cdi-spec.org/">CDI 2.0</a>.
Initially, we plan on releasing Alpha releases every two weeks starting in early October.</p>
</div>
<div class="paragraph">
<p>The Alpha releases are likely to break compatibility from time to time and will often contain bleeding edge or prototype code.
The goals is however to give the CDI community a chance to test drive the proposed changes in the CDI specification as soon as possible and give quick feedback to the CDI expert group.</p>
</div>
<div class="paragraph">
<p>Weld 3.0 will also be a good opportunity to get involved in the development of this open-source project. <strong>Interested?</strong> See our <a href="http://weld.cdi-spec.org/community/">community web page</a> for more details.</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div class="post">
<h2>
<a href="/news/2014/04/15/weld-220-final/">Weld 2.2 (CDI 1.2 reference implementation) released!</a>
</h2>
<div class="news-date news-boxed">
2014-4-15
&nbsp;
<i class="fa fa-pencil"></i>
Jozef Hartinger
</div>
<p></p>
<div class="content">
<div class="paragraph">
<p>Today we released Weld 2.2.0.Final - the reference implementation of <a href="http://docs.jboss.org/cdi/spec/1.2/cdi-spec.html">Contexts and Dependency Injection for Java EE 1.2 (CDI 1.2)</a>.
Besides implementing the changes in the specification, this release comes with several new features, performance improvements and more than 50 bug fixes.</p>
</div>
<div class="sect1">
<h2 id="_cdi_1_2">CDI 1.2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CDI 1.2 is a maintenance release of the <a href="https://jcp.org/en/jsr/detail?id=346">CDI specification</a>. It contains a number of small fixes and clarifications as well as several enhancements.
Most notable changes for application developers are related to the definition of <em>bean defining annotations</em>.</p>
</div>
<div class="paragraph">
<p>In <a href="http://docs.jboss.org/cdi/spec/1.2/cdi-spec.html#bean_defining_annotations">CDI 1.2</a>, the set of bean defining annotations now contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all the normal scope annotations (e.g. @RequestScoped, @ApplicationScoped, &#8230;&#8203;)</p>
</li>
<li>
<p>the built-in @Dependent scope</p>
</li>
<li>
<p>@Interceptor and @Decorator annotations</p>
</li>
<li>
<p>stereotype annotations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a result, any class annotated with a <em>bean defining annotation</em> is by default recognized by the application server and registered as a CDI bean. The beans.xml file is optional.</p>
</div>
<div class="paragraph">
<p>In addition, there are other fixes, clarifications and minor enhancements in this maintenance release of the CDI specification.
See <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12311062&amp;version=12323655">the release notes</a> for the complete list of changes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_performance">Performance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Weld is now capable of using bytecode-scanning utilities, such as the <a href="https://github.com/wildfly/jandex">Jandex</a> tool, to speed up deployment.
This is especially notable in extra large deployments (e.g. 5000+ classes) where we observed up to <strong>20% faster deployment</strong>.</p>
</div>
<div class="paragraph">
<p>In addition, there are noticeable improvements in the following areas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>runtime performance of observers, interceptors and decorators</p>
</li>
<li>
<p>session replication overhead (failover)</p>
</li>
<li>
<p>memory consumption</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_weld_2_2_on_wildfly">Weld 2.2 on WildFly</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://wildfly.org">WildFly</a> does not come with Weld 2.2 support yet. It is however easy to patch an existing WildFly installation to use Weld 2.2.</p>
</div>
<div class="paragraph">
<p>To do so, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download a patch appropriate for the WildFly version (e.g. 8.0.0.Final) from the <a href="http://sourceforge.net/projects/jboss/files/Weld/2.2.0.Final/">download section</a></p>
</li>
<li>
<p>In the WildFly installation, run the CLI console</p>
<div class="listingblock">
<div class="content">
<pre>sh jboss-cli.sh</pre>
</div>
</div>
</li>
<li>
<p>From the console run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>patch apply /path/to/wildfly-8.0.0.Final-weld-2.2.0.Final-patch.zip</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Your installation is now patched!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_weld_se_and_servlet">Weld SE and Servlet</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Weld comes with the SE module which allows CDI to be used in plain Java SE environment. In Weld 2.2 we added partial support for implicit bean archives.
Partial support here means that the beans.xml file is still required, but <strong>bean-discovery-mode=”annotated”</strong> can be specified for Weld to only discover classes explicitly annotated with bean defining annotations (see above).</p>
</div>
<div class="paragraph">
<p>In addition to the Weld SE module, Weld also provides the Weld Servlet module which makes it possible to use Weld on top of a plain Servlet container, such as Apache Tomcat or Jetty.</p>
</div>
<div class="paragraph">
<p>In this release we simplified configuration by bootstrapping Weld using the <em>ServletContainerInitializer</em>.</p>
</div>
<div class="paragraph">
<p>Furthermore, Weld Servlet now supports <strong>Jetty 9.1</strong>. At the same time, the support for <strong>Tomcat 6 was dropped</strong>. To summarize, Weld Servlet is currently supported on the following Servlet containers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tomcat 7, 8</p>
</li>
<li>
<p>Jetty 7, 8, 9.0, 9.1</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgement">Acknowledgement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We greatly appreciate your contributions to this release.
Big thanks go to: Martin Kouba, Matúš Abaffy, Matej Briškár, Ron Šmeral, Marek Schmidt, Marko Lukša, Tomáš Remeš, Stuart Douglas, Radoslav Husár, Max Pimm, Alexandre Gattiker, Antonin Stefanutti and Steve Moyer.</p>
</div>
<div class="paragraph">
<p>&#91; <a href="http://docs.jboss.org/cdi/api/1.2/">CDI 1.2 API</a> &#93;
&#91; <a href="http://weld.cdi-spec.org/download/">Download</a> &#93;
&#91; <a href="http://docs.jboss.org/weld/reference/2.2.0.Final/en-US/html/">Documentation</a> &#93;
&#91; <a href="https://issues.jboss.org/issues/?filter=12321473">Release notes</a> &#93;</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div class="post">
<h2>
<a href="/news/2014/02/04/weld-220-alpha1/">CDI 1.2 and Weld 2.2</a>
</h2>
<div class="news-date news-boxed">
2014-2-4
&nbsp;
<i class="fa fa-pencil"></i>
Jozef Hartinger
</div>
<p></p>
<div class="content">
<div class="paragraph">
<p>Work on a maintenance release of the CDI specification (CDI 1.2) has started recently. Now is the best time to add feedback on <a href="http://www.cdi-spec.org/news/2013/12/16/CDI-1-2-issues-list/">issues being addressed</a>. Most of the discussion happens in the <a href="https://lists.jboss.org/mailman/listinfo/cdi-dev">cdi-dev mailing list</a> or the <a href="http://webchat.freenode.net/?channels=jsr346">IRC channel</a>.</p>
</div>
<div class="paragraph">
<p><strong>Weld 2.2</strong> is going to be the reference implementation of CDI 1.2. Besides implementing the changes introduced in the maintenance release, we are going to focus on improving non-functional characteristics in this release of Weld:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>bootstrap time</p>
</li>
<li>
<p>memory footprint</p>
</li>
<li>
<p>throughput</p>
</li>
<li>
<p>maximum number of concurrent clients</p>
</li>
<li>
<p>session replication overhead</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Today, we released <strong>Weld 2.2.0.Alpha1</strong>. The most significant changes include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Added <a href="http://docs.jboss.org/weld/javadoc/2.2/weld-spi/org/jboss/weld/resources/spi/ClassFileInfo.html">new SPI</a> that allows bytecode-scanning frameworks (such as <a href="https://github.com/wildfly/jandex">jandex</a>) to be integrated. This yields improved bootstrap time especially with large deployments.</p>
</li>
<li>
<p>Reduced memory consumption (our tests show 6-12% less memory used after bootstrap with large deployments)</p>
</li>
<li>
<p>Improved event/observer performance</p>
</li>
<li>
<p>Java Web Start support finally got in (thanks to Alexandre Gattiker for the patch!)</p>
</li>
<li>
<p>Improved Servlet container support (Jetty 9.1, ServletContainerInitializer used to bootstrap Weld, Tomcat 8 support)</p>
</li>
<li>
<p>A new Groovy example (groovy-numberguess) was added</p>
</li>
<li>
<p>Many other bug fixes and improvements. See the <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310891&amp;version=12322332">release notes</a> for a complete list of changes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now, we continue to work on Weld 2.2. Expect the final version in late March. In the meantime, try this release and let us know what you think in the <a href="https://community.jboss.org/en/weld">forum</a>. If you are interested in Weld make sure you check our <a href="http://weld.cdi-spec.org/community/">community page</a> or the <a href="https://issues.jboss.org/issues/?filter=12320398">list of open issues awaiting contribution</a>.</p>
</div>
<div class="paragraph">
<p>&#91; <a href="https://sourceforge.net/projects/jboss/files/Weld/2.2.0.Alpha1">Distribution</a> &#93;
&#91; <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12310891&amp;version=12322332">Release notes</a> &#93;
&#91; <a href="http://docs.jboss.org/weld/reference/2.2.0.Alpha1/en-US/html/">Documentation</a> &#93;
&#91; <a href="http://docs.jboss.org/cdi/api/1.1/">CDI 1.1 Javadoc</a> &#93;</p>
</div>
</div>
<hr>
</div>
<div class="pagination-links"><a href="/news/page/12.html" class="previous-link">Previous</a> <a href="/news/" class="page-link">1</a> <a href="/news/page/2.html" class="page-link">2</a> <span class="skip">...</span><a href="/news/page/12.html" class="page-link">12</a> <span class="current-page">13</span> <a href="/news/page/14.html" class="page-link">14</a> <a href="/news/page/15.html" class="page-link">15</a> <a href="/news/page/14.html" class="next-link">Next</a> </div>
<hr>
<div>
<a href="http://weld.cdi-spec.org/news.atom">
<i class="fa fa-rss"></i>
Subscribe to Weld news
</a>
</div>

</div>
</div>
</div>
</div>
</div>
<footer>
<div class="row">
<div class="container" id="companyfooter">
<div class="redhatlogo" style="text-align:center;">
<div class="logospacer" style="height:10px;"></div>
<a href="http://www.redhat.com/">
<img src="https://static.jboss.org/theme/images/common/redhat_logo.png">
</a>
</div>
</div>
</div>
</footer>
</body>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount','UA-45187401-1']);
_gaq.push(['_trackPageview']);
(function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<script>
  $(document).ready(function() {
    $('#toggle_menu').click(function(){
      $("#mobile_menu").toggle();
    });
  });
</script>
</html>
