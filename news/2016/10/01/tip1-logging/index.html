<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>
Weld: Weld Tip 1 - Logging
</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<meta content="Weld Tips 1 - Logging" name="description">
<link href="/images/weld_icon_32x.ico" rel="shortcut icon" type="image/x-icon">
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href="//static.jboss.org/css/tabzilla.css" media="screen" rel="stylesheet" type="text/css">
<link href="https://weld.cdi-spec.org/stylesheets/styles.css" rel="stylesheet" type="text/css">
<script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="//static.jboss.org/js/_jbossorg-tabzilla.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="//html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
<![endif]-->
<link href="https://weld.cdi-spec.org/news.atom" rel="alternate" type="application/atom+xml">
<link href="//cdn.jsdelivr.net/highlight.js/8.9.1/styles/hybrid.min.css" rel="stylesheet">
<script src="//cdn.jsdelivr.net/highlight.js/8.9.1/highlight.min.js" type="text/javascript"></script>
<script>
hljs.initHighlightingOnLoad();
</script>
</head>
<body>
<div class="container-fluid">
<div class="row">
<div class="col-md-2 col-sm-3">
<div class="sidebar-nav">
<div class="navbar navbar-default" role="navigation">
<div class="navbar-header">
<button ="button" class="navbar-toggle" data-target=".sidebar-navbar-collapse" data-toggle="collapse">
<span class="sr-only">
Toggle navigation
</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a ="#" class="visible-xs navbar-brand">
<img alt="Weld Logo" src="/images/weld_logo_100x.png">
</a>
</div>
<div class="collapse navbar-collapse sidebar-navbar-collapse">
<ul class="nav navbar-nav">
<li>
<a href="/">
<i class="fa fa-home"></i>
&nbsp;Home
</a>
</li>
<li>
<a href="/download">
<i class="fa fa-download"></i>
&nbsp;Download
</a>
</li>
<li>
<a href="/news">
<i class="fa fa-newspaper-o"></i>
&nbsp;News
</a>
</li>
<li>
<a href="https://issues.jboss.org/projects/WELD?selectedItem=com.atlassian.jira.jira-projects-plugin:release-page" target="_blank">
<i class="fa fa-road"></i>
&nbsp;Road Map
</a>
</li>
<li>
<a href="/documentation">
<i class="fa fa-book"></i>
&nbsp;Docs &amp; FAQ
</a>
</li>
<li>
<a href="/news/tags/tips">
<i class="fa fa-lightbulb-o"></i>
&nbsp;Tips and Tricks
</a>
</li>
<li>
<a href="/community">
<i class="fa fa-group"></i>
&nbsp;Community
</a>
</li>
<li>
<a href="http://github.com/weld" target="_blank">
<i class="fa fa-github-alt"></i>
&nbsp;Source Code
</a>
</li>
<li>
<a href="https://issues.jboss.org/browse/WELD#selectedTab=com.atlassian.jira.plugin.system.project%3Asummary-panel" target="_blank">
<i class="fa fa-tasks"></i>
&nbsp;Bug Tracker
</a>
</li>
<li>
<a href="https://twitter.com/jbossweld" target="_blank">
<i class="fa fa-twitter"></i>
&nbsp;Follow @jbossweld
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="col-md-10 col-sm-9">
<div class="row hidden-xs">
<div class="dropup">
<div id="ajbossproject">
A JBoss Project
</div>
<a class="tabnav-closed" href="#" id="tab">Red Hat</a>
<script>
window.addEventListener('load', function() {renderTabzilla("Weld", "weld", false )}, false);
</script>
</div>
</div>
<div class="row">
<div class="col-md-4">
<a href="/">
<img alt="Weld Logo" class="hidden-xs weld-home-logo" src="/images/weld_logo_450x.png">
</a>
</div>
<div class="col-md-8">
<img alt="CDI tagcloud" class="hidden-xs hidden-sm cdi-background" src="/images/CDIbackground.png">
</div>
</div>
<div class="row content-wrapper">
<div class="col-md-12">
<div class="post">
<h1>
Weld Tip 1 - Logging
<a href="http://weld.cdi-spec.org/news.atom" title="Subscribe to Weld news">
<i class="fa fa-rss"></i>
</a>
</h1>
<div class="news-date news-boxed">
2016-10-1
&nbsp;
<span class="tags">
<i class="fa fa-tags"></i>
<a href="/news/tags/tips">tips</a>
</span>
&nbsp;
<i class="fa fa-pencil"></i>
Martin Kouba
</div>
<p></p>
<div class="content">
<div id="toc" class="toc">
<div id="toctitle" class="title">Contents</div>
<ul class="sectlevel1">
<li><a href="#_motivation">Motivation</a></li>
<li><a href="#under_the_hood">Under the hood</a></li>
<li><a href="#filter">Set the log level and use categories to filter messages</a></li>
<li><a href="#bootstrap">Monitoring bootstrap</a>
<ul class="sectlevel2">
<li><a href="#_registered_beans">Registered beans</a></li>
<li><a href="#_actions_performed_by_extensions">Actions performed by extensions</a></li>
</ul>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is the first article from a series of short articles covering some useful Weld features.
In this article we talk about logging.
The topics for the next articles include: <strong>DEVELOPMENT MODE</strong>, <strong>PERFORMANCE</strong>, <strong>NON-EE ENVIRONMENTS</strong> and <strong>TESTING</strong>.</p>
</div>
<div class="sect1">
<h2 id="_motivation">Motivation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Logging is usually no fancy stuff.
But very often it&#8217;s <em>the best thing to start with if problems arise</em>.
Moreover, it&#8217;s the easiest form of debugging.</p>
</div>
<div class="paragraph">
<p>In this article you will find:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#under_the_hood">Under the hood</a> - how to control and configure the output</p>
</li>
<li>
<p><a href="#filter">Set the log level and use categories to filter messages</a> - how to keep logs small and to the point</p>
</li>
<li>
<p><a href="#bootstrap">Monitoring bootstrap</a> - registered beans, actions performed by extensions</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="under_the_hood">Under the hood</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Weld is using <a href="https://developer.jboss.org/wiki/JBossLoggingTooling">JBoss Logging</a>.
This is an abstraction layer wchich does not "write" any log messages at all.
Instead, it effectively constructs a log message and then delegates to a back-end logging framework.
The supported frameworks include <a href="https://developer.jboss.org/wiki/StandaloneJBossLogManager">jboss-logmanager</a>, <a href="http://logging.apache.org/log4j/2.x/">Log4j</a>, <a href="http://www.slf4j.org/">SLF4J</a> and JDK logging.</p>
</div>
<div class="paragraph">
<p>So which logging framework is actually used to write the Weld messages?
Well, it depends on the environment.
In a <strong>Java EE container</strong> (e.g. WildFly) the logging configuration is under the direction of the container.
You should follow the container-specific guides to change the configuration (see for example <a href="https://docs.jboss.org/author/display/WFLY10/Logging+Configuration">WildFly - Logging Configuration</a> and <a href="/documentation/#7">How do I enable debug logging for Weld in a specific container?</a>).</p>
</div>
<div class="paragraph">
<p>A web application deployed to a <strong>servlet container</strong> usually bundles a logging framework and possibly some configuration file.
In this case, the configuration is in hands of the application developer.
If no logging framework is bundled follow the container-specific guides to change the configuration (e.g. <a href="http://tomcat.apache.org/tomcat-8.0-doc/logging.html">Logging in Tomcat</a>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
A system property <code>org.jboss.logging.provider</code> can be used to specify the logging framework directly. If not set, the JBoss Logging will attempt to find the "best match" on the classpath. See also <a href="https://github.com/jboss-logging/jboss-logging/blob/master/src/main/java/org/jboss/logging/LoggerProviders.java" target="_blank" rel="noopener">LoggerProviders</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In <strong>Java SE</strong> the situation is very similar to servlet containers except the class loading is usually even less complicated (see also <a href="/documentation/#10"> How do I enable debug logging for Weld SE?</a>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="filter">Set the log level and use categories to filter messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default log level is usually <code>INFO</code>.
Weld does not log that much information with this level.
You will have to set the log level to <code>DEBUG</code> (or even <code>TRACE</code>) to see what&#8217;s going on in your application.
If you set the level globally (for all frameworks and libraries), the log files will be bloated and it will be very hard to get some relevant info from there.
If you set the level for Weld only (i.e. for <code>org.jboss.weld</code>), it should be better.
Moreover, it&#8217;s possible to use categories to filter messages from a particular "domain".
Weld log messages are grouped into several categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.jboss.weld.Bootstrap</code></p>
</li>
<li>
<p><code>org.jboss.weld.Validator</code></p>
</li>
<li>
<p><code>org.jboss.weld.Bean</code></p>
</li>
<li>
<p><code>org.jboss.weld.Context</code></p>
</li>
<li>
<p><code>org.jboss.weld.El</code></p>
</li>
<li>
<p>and others (see also <a href="https://github.com/weld/core/blob/master/impl/src/main/java/org/jboss/weld/logging/Category.java" target="_blank" rel="noopener">org.jboss.weld.logging.Category</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So for example, if you&#8217;re only interested in log messages related to <strong>EL resolution</strong> set the log level for the <code>org.jboss.weld.El</code> category to <code>TRACE</code> (or level with corresponding priority).
Another useful example is the check of <a href="http://docs.jboss.org/weld/reference/latest/en-US/html/configure.html#_weld_configuration" target="_blank" rel="noopener">Weld configuration</a>.
Simply set the log level to <code>DEBUG</code> and filter the <code>org.jboss.weld.Configuration</code> category:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>DEBUG [Configuration] WELD-001907: Reading properties file: test.war/WEB-INF/classes/weld.properties&#x000A;DEBUG [Configuration] WELD-001903: Configuration key RESOLUTION_CACHE_SIZE already set to 1Â 000 in a source with higher priority, value 500 from system properties is ignored&#x000A;DEBUG [Configuration] WELD-001904: Unsupported configuration key found and ignored: com.foo.bar&#x000A;DEBUG [Configuration] WELD-001902: Configuration initialized: {CONCURRENT_DEPLOYMENT=false, RESOLUTION_CACHE_SIZE=1000, RELAXED_CONSTRUCTION=true}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootstrap">Monitoring bootstrap</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CDI is designed to fail fast.
An extensive validation is performed during application initialization in order to avoid malicious errors at runtime.
Container usually also logs a lot of interesting info during bootstrap.
Let&#8217;s try to set the log level to <strong>DEBUG</strong> for the <code>org.jboss.weld.Bootstrap</code> category and see what we get.</p>
</div>
<div class="sect2">
<h3 id="_registered_beans">Registered beans</h3>
<div class="paragraph">
<p>As simple as it looks - Weld logs <em>all the beans</em> found in the application, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>DEBUG [Bootstrap] WELD-000106: Bean: Managed Bean [class org.jboss.cdi.tck.tests.lookup.dependency.resolution.broken.unsatisfied.Vanilla] with qualifiers [@Any @Default]&#x000A;DEBUG [Bootstrap] WELD-000106: Bean: Producer Method [String[]] with qualifiers [@BatchProperty @Any] declared as [[UnbackedAnnotatedMethod] @Produces @BatchProperty public org.jberet.creation.BatchBeanProducer.getStringArray(InjectionPoint)]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_actions_performed_by_extensions">Actions performed by extensions</h3>
<div class="paragraph">
<p>There is no doubt that portable extensions are really powerful.
They can change almost anything.
That&#8217;s great for framework/libraries developers.
On the other hand, this may cause problems when looking for a bug.
There is an application class provided by a developer but what does the CDI container actually see?
Well, it depends&#8230;&#8203; because portable extensions are allowed to redefine this.
And that&#8217;s why Weld logs all the <em>"modification"</em> operations performed by extensions, such as <code>ProcessAnnotatedType.veto()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>DEBUG [Bootstrap] WELD-000148: ProcessAnnotatedType.veto() called by com.foo.MyExtension@50fed5b1 for [BackedAnnotatedType] public class com.foo.Foo</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If your application deploys successfully, you can use <a href="http://docs.jboss.org/weld/reference/latest/en-US/html/devmode.html#devtools">Development Tools</a> to inspect the runtime info (will be covered in one of the follow-up articles).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>

            <div id="disqus_thread"></div>
            <script type="text/javascript">
            var disqus_shortname = 'weld-cdi';
            var disqus_url = "https://weld.cdi-spec.org/news/2016/10/01/tip1-logging/";
            var disqus_developer = null;
            var disqus_identifier = "d6caa7f663b8e48b0e0f1a2125e3cf1e80b09b70";
            (function() {
              var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=weld-cdi">comments powered by Disqus.</a></noscript>
          
</div>

</div>
</div>
</div>
</div>
</div>
<footer>
<div class="row">
<div class="container" id="companyfooter">
<div class="redhatlogo" style="text-align:center;">
<div class="logospacer" style="height:10px;"></div>
<a href="http://www.redhat.com/">
<img src="https://static.jboss.org/theme/images/common/redhat_logo.png">
</a>
</div>
</div>
</div>
</footer>
</body>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount','UA-45187401-1']);
_gaq.push(['_trackPageview']);
(function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<script>
  $(document).ready(function() {
    $('#toggle_menu').click(function(){
      $("#mobile_menu").toggle();
    });
  });
</script>
</html>
